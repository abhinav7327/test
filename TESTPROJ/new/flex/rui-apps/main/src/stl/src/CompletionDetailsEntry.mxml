<?xml version="1.0" encoding="utf-8"?>
<mx:Module xmlns:mx="http://www.adobe.com/2006/mxml"  xmlns:flexlib="http://code.google.com/p/flexlib/" layout="vertical"
    xmlns:cntrls="com.nri.rui.core.controls.*" xmlns:frmtrs="com.nri.rui.core.formatters.*" xmlns:valdtrs="com.nri.rui.core.validators.*" xmlns:controls="*" creationComplete="submitQueryResult()" width="100%" height="100%">
    <mx:Script>
        <![CDATA[
            import mx.events.CloseEvent;
            import mx.managers.PopUpManager;
            import mx.collections.ArrayCollection;
            import com.nri.rui.core.controls.XenosAlert;
            import com.nri.rui.core.Globals;            
        ]]>
    </mx:Script>
    <mx:Script source = "actionscripts/CompletionDetailsEntry.as"/>
    
    <cntrls:XenosHTTPService id="stlDetailPageRequest"
         showBusyCursor="true"
         method="POST" 
         url="" 
         result="loadResultPage(event)" 
         fault="XenosAlert.error(this.parentApplication.xResourceManager.getKeyValue('inf.label.error.occurred') + event.fault.faultString)"
         useProxy="false" resultFormat="xml">
    </cntrls:XenosHTTPService>

    <cntrls:XenosHTTPService id="submitDetailInfoRequest"
         showBusyCursor="true"
         method="POST" 
         url=""
         result="submitDetailPage(event)" 
         fault="XenosAlert.error(this.parentApplication.xResourceManager.getKeyValue('inf.label.error.occurred') + event.fault.faultString)"
         useProxy="false" resultFormat="xml">
    </cntrls:XenosHTTPService>

    <cntrls:XenosHTTPService id="addReasonCodeService"
         showBusyCursor="true"
         method="POST" 
         url=""
         fault="XenosAlert.error(this.parentApplication.xResourceManager.getKeyValue('inf.label.error.occurred') + event.fault.faultString)"
         useProxy="false">
    </cntrls:XenosHTTPService>

    <cntrls:XenosHTTPService id="removeReasonCodeService"
         showBusyCursor="true"
         method="POST" 
         url=""
         fault="XenosAlert.error(this.parentApplication.xResourceManager.getKeyValue('inf.label.error.occurred') + event.fault.faultString)"
         useProxy="false">
    </cntrls:XenosHTTPService>

    <frmtrs:XenosNumberFormatter id="numberFormatter" useThousandsSeparator="true" />
    <valdtrs:XenosNumberValidator id="completionQuantityVal" 
                                  source="{completionQuantity}" 
                                  property="text" 
                                  allowNegative="false" 
                                  domain="real" 
                                  negativeError="{this.parentApplication.xResourceManager.getKeyValue('stl.label.completion.detailsentry.completionquantity.cannot.benegative')}"
                                  requiredFieldError=""
                                  invalidCharError="{this.parentApplication.xResourceManager.getKeyValue('stl.label.completion.detailsentry.enter.validvalue.for.completionquantity')}" 
                                  exceedsMaxError="{this.parentApplication.xResourceManager.getKeyValue('stl.label.completion.detailsentry.max.fifteendigits.allowed.before.decimalpoint')}"                                     
                                  separationError=""
                                  lowerThanMinError="" 
                                  maxValue="999999999999999" 
                                  minValue="" 
                                  invalidFormatCharsError="{this.parentApplication.xResourceManager.getKeyValue('stl.label.completion.detailsentry.enter.validvalue.for.completionquantity')}" 
                                  decimalPointCountError="{this.parentApplication.xResourceManager.getKeyValue('stl.label.completion.detailsentry.enter.validvalue.for.completionquantity')}" 
                                  precision="3" 
                                  precisionError="{this.parentApplication.xResourceManager.getKeyValue('stl.label.completion.detailsentry.max.threedigits.allowed.after.decimalpoint')}" />
    <valdtrs:XenosNumberValidator id="completeAmountPartialVal" 
                                  source="{completeAmountPartial}" 
                                  property="text" 
                                  allowNegative="false" 
                                  domain="real" 
                                  negativeError="{this.parentApplication.xResourceManager.getKeyValue('stl.label.completion.detailsentry.completionamount.cannot.benegative')}"
                                  requiredFieldError=""
                                  invalidCharError="{this.parentApplication.xResourceManager.getKeyValue('stl.label.completion.detailsentry.enter.validvalue.for.completionamount')}" 
                                  exceedsMaxError="{this.parentApplication.xResourceManager.getKeyValue('stl.label.completion.detailsentry.max.fifteendigits.allowed.before.decimalpoint')}"                                     
                                  separationError=""
                                  lowerThanMinError="" 
                                  maxValue="999999999999999" 
                                  minValue="" 
                                  invalidFormatCharsError="{this.parentApplication.xResourceManager.getKeyValue('stl.label.completion.detailsentry.enter.validvalue.for.completionamount')}" 
                                  decimalPointCountError="{this.parentApplication.xResourceManager.getKeyValue('stl.label.completion.detailsentry.enter.validvalue.for.completionamount')}" 
                                  precision="3" 
                                  precisionError="{this.parentApplication.xResourceManager.getKeyValue('stl.label.completion.detailsentry.max.threedigits.allowed.after.decimalpoint')}" />
    <valdtrs:XenosNumberValidator id="completeAmountCompleteVal" 
                                  source="{completeAmountComplete}" 
                                  property="text" 
                                  allowNegative="false" 
                                  domain="real" 
                                  negativeError="{this.parentApplication.xResourceManager.getKeyValue('stl.label.completion.detailsentry.completionamount.cannot.benegative')}"
                                  requiredFieldError=""
                                  invalidCharError="{this.parentApplication.xResourceManager.getKeyValue('stl.label.completion.detailsentry.enter.validvalue.for.completionamount')}" 
                                  exceedsMaxError="{this.parentApplication.xResourceManager.getKeyValue('stl.label.completion.detailsentry.max.fifteendigits.allowed.before.decimalpoint')}"                                     
                                  separationError=""
                                  lowerThanMinError="" 
                                  maxValue="999999999999999" 
                                  minValue="" 
                                  invalidFormatCharsError="{this.parentApplication.xResourceManager.getKeyValue('stl.label.completion.detailsentry.enter.validvalue.for.completionamount')}" 
                                  decimalPointCountError="{this.parentApplication.xResourceManager.getKeyValue('stl.label.completion.detailsentry.enter.validvalue.for.completionamount')}" 
                                  precision="3" 
                                  precisionError="{this.parentApplication.xResourceManager.getKeyValue('stl.label.completion.detailsentry.max.threedigits.allowed.after.decimalpoint')}" />
    <valdtrs:XenosNumberValidator id="eligibleBalanceVal" 
                                  source="{eligibleBalance}" 
                                  property="text" 
                                  allowNegative="false" 
                                  domain="real" 
                                  negativeError="{this.parentApplication.xResourceManager.getKeyValue('stl.label.completion.detailsentry.elligiblebalance.cannot.benegative')}"
                                  requiredFieldError=""
                                  invalidCharError="{this.parentApplication.xResourceManager.getKeyValue('stl.label.completion.detailsentry.enter.validvalue.for.elligiblebalance')}" 
                                  exceedsMaxError="{this.parentApplication.xResourceManager.getKeyValue('stl.label.completion.detailsentry.max.fifteendigits.allowed.before.decimalpoint')}"                                     
                                  separationError=""
                                  lowerThanMinError="" 
                                  maxValue="999999999999999" 
                                  minValue="" 
                                  invalidFormatCharsError="{this.parentApplication.xResourceManager.getKeyValue('stl.label.completion.detailsentry.enter.validvalue.for.elligiblebalance')}" 
                                  decimalPointCountError="{this.parentApplication.xResourceManager.getKeyValue('stl.label.completion.detailsentry.enter.validvalue.for.elligiblebalance')}" 
                                  precision="3" 
                                  precisionError="{this.parentApplication.xResourceManager.getKeyValue('stl.label.completion.detailsentry.max.threedigits.allowed.after.decimalpoint')}" />
    <valdtrs:XenosNumberValidator id="taxAmountVal" 
                                  source="{taxAmount}" 
                                  property="text" 
                                  allowNegative="false" 
                                  domain="real" 
                                  negativeError="{this.parentApplication.xResourceManager.getKeyValue('stl.label.completion.detailsentry.taxamount.cannot.benegative')}"
                                  requiredFieldError=""
                                  invalidCharError="{this.parentApplication.xResourceManager.getKeyValue('stl.label.completion.detailsentry.enter.validvalue.for.taxamount')}" 
                                  exceedsMaxError="{this.parentApplication.xResourceManager.getKeyValue('stl.label.completion.detailsentry.max.fifteendigits.allowed.before.decimalpoint')}"                                     
                                  separationError=""
                                  lowerThanMinError="" 
                                  maxValue="999999999999999" 
                                  minValue="" 
                                  invalidFormatCharsError="{this.parentApplication.xResourceManager.getKeyValue('stl.label.completion.detailsentry.enter.validvalue.for.taxamount')}" 
                                  decimalPointCountError="{this.parentApplication.xResourceManager.getKeyValue('stl.label.completion.detailsentry.enter.validvalue.for.taxamount')}" 
                                  precision="3" 
                                  precisionError="{this.parentApplication.xResourceManager.getKeyValue('stl.label.completion.detailsentry.max.threedigits.allowed.after.decimalpoint')}" />

    <mx:states>
        <mx:State name="remarksEntry">
            <mx:AddChild position="lastChild">
                <mx:target>
                    <mx:VBox id="remarksBox" width="100%" height="100%" verticalGap="0" horizontalGap="0" >
                        <cntrls:XenosErrors id="errPageCompRemarks" width="100%" color="#FF0000" backgroundAlpha="0" borderStyle="none"/>
                        <mx:Canvas width="100%" height="100%" horizontalScrollPolicy="auto" verticalScrollPolicy="auto">
<!--                            <controls:SettlementDetailSummaryView dataProvider="{this.queryResult}" width="100%" height="100%"/> -->
					        <mx:VBox width="100%" height="100%">
					            <mx:Grid verticalGap="0" horizontalGap="0" width="100%">
					                 <mx:GridRow width="100%">
					                     <mx:GridItem width="20%" styleName="LabelBgColor">
					                        <mx:Label text="{this.parentApplication.xResourceManager.getKeyValue('stl.label.remarks1')}" />
					                     </mx:GridItem>
					                     <mx:GridItem width="30%">
					                        <mx:TextInput id="remarks1" restrict="{Globals.INPUT_PATTERN}"/>
					                     </mx:GridItem>
					                     <mx:GridItem width="20%" styleName="LabelBgColor">
					                        <mx:Label text="{this.parentApplication.xResourceManager.getKeyValue('stl.label.remarks2')}" />
					                     </mx:GridItem>
					                     <mx:GridItem width="30%">
					                        <mx:TextInput id="remarks2" restrict="{Globals.INPUT_PATTERN}"/>
					                     </mx:GridItem>             
					                 </mx:GridRow>
					                 <mx:GridRow width="100%">
					                     <mx:GridItem width="20%" styleName="LabelBgColor">
					                        <mx:Label text="{this.parentApplication.xResourceManager.getKeyValue('stl.label.reasoncode')}" />
					                     </mx:GridItem>
					                     <mx:GridItem width="30%">
					                        <mx:ComboBox id="reasonCode" dataProvider="{reasonCodeList}" labelField="label" width="160"/>
					                        <mx:Button id="addButton" label="Add" styleName="BtnStyle" click="addReasonCode()"/>
					                     </mx:GridItem>
					                     <mx:GridItem width="20%" styleName="LabelBgColor">
					                     </mx:GridItem>
					                     <mx:GridItem width="30%">
					                     </mx:GridItem>
					                 </mx:GridRow>
					            </mx:Grid>
					            <mx:VBox width="100%" height="60" id="rslt" horizontalScrollPolicy="off" verticalScrollPolicy="off" styleName="HDivideStyle" visible="{reasonCodeResult.length > 0}" includeInLayout="{reasonCodeResult.length > 0}">
					                <cntrls:CustomDataGrid id="reasonCodeSummary" width="100%" height="100%" dataProvider="{reasonCodeResult}" sortableColumns="true" variableRowHeight="true" horizontalScrollPolicy="off" verticalScrollPolicy="off">
					                    <cntrls:columns>
                                            <mx:DataGridColumn textAlign="center" headerText="{this.parentApplication.xResourceManager.getKeyValue('stl.label.reasoncode')}" dataField="reasonCode" rendererIsEditor="true"/>
                                            <mx:DataGridColumn textAlign="center" headerText="{this.parentApplication.xResourceManager.getKeyValue('stl.label.narrative')}" dataField="reasonNarrative" rendererIsEditor="true"/>
                                            <mx:DataGridColumn textAlign="center" rendererIsEditor="true">
												<mx:itemRenderer>
												<mx:Component>
												    <mx:HBox width="100%" height="100%" horizontalAlign="center" verticalAlign="middle" horizontalScrollPolicy="off" verticalScrollPolicy="off">
												        <mx:Button id="btn" label="delete" width="18" height="18" styleName="BtnDelete" click="this.parentDocument.deleteReasonCode(outerDocument.reasonCodeSummary.selectedIndex)"/>
												    </mx:HBox>
												</mx:Component>
												</mx:itemRenderer> 
                                            </mx:DataGridColumn>
									   </cntrls:columns>
                                   </cntrls:CustomDataGrid>
					            </mx:VBox>          
                                <flexlib:WindowShade id="ws1" tabChildren="{ws1.opened=true}" styleName="linkButtonWindowShade" label="Security Side Settlement Details" width="100%" visible="{queryResult.selectedCompletionDetails.securitySidePresent == true}" includeInLayout="{queryResult.selectedCompletionDetails.securitySidePresent == true}">
                                    <mx:Grid verticalGap="0" horizontalGap="0" width="100%">
                                         <mx:GridRow width="100%">
                                             <mx:GridItem width="20%" styleName="LabelBgColor">
                                                <mx:Label text="{this.parentApplication.xResourceManager.getKeyValue('stl.label.settlementbank')}" />
                                             </mx:GridItem>
                                             <mx:GridItem width="30%">
                                                <mx:Label text="{queryResult.selectedCompletionDetails.settleBankSecurity}"/>
                                             </mx:GridItem>
                                             <mx:GridItem width="20%" styleName="LabelBgColor">
                                                <mx:Label text="{this.parentApplication.xResourceManager.getKeyValue('stl.label.settleac')}" />
                                             </mx:GridItem>
                                             <mx:GridItem width="30%">
                                                <mx:Label text="{queryResult.selectedCompletionDetails.settleAccountSecurity}"/>
                                             </mx:GridItem>             
                                         </mx:GridRow>
                                         <mx:GridRow width="100%">
                                             <mx:GridItem width="20%" styleName="LabelBgColor">
                                                <mx:Label text="{this.parentApplication.xResourceManager.getKeyValue('stl.label.securitycode')}" />
                                             </mx:GridItem>
                                             <mx:GridItem width="30%">
                                                <mx:Label text="{queryResult.selectedCancelCompletionView.instrumentCode}"/>
                                             </mx:GridItem>
                                             <mx:GridItem width="20%" styleName="LabelBgColor">
                                                <mx:Label text="{this.parentApplication.xResourceManager.getKeyValue('stl.label.securityname')}" />
                                             </mx:GridItem>
                                             <mx:GridItem width="30%">
                                                <mx:Label text="{queryResult.selectedCancelCompletionView.securityName}"/>
                                             </mx:GridItem>
                                         </mx:GridRow>
                                         <mx:GridRow width="100%">
                                             <mx:GridItem width="20%" styleName="LabelBgColor">
                                                <mx:Label text="{this.parentApplication.xResourceManager.getKeyValue('ref.common.label.alternatesecurityid')}" />
                                             </mx:GridItem>
                                             <mx:GridItem width="80%" colSpan="3">
                                                <mx:Label text="{queryResult.selectedCancelCompletionView.displayAlternativeSecId}"/>
                                             </mx:GridItem>
                                         </mx:GridRow>
                                         <mx:GridRow width="100%">
                                             <mx:GridItem width="20%" styleName="LabelBgColor">
                                                <mx:Label text="{this.parentApplication.xResourceManager.getKeyValue('stl.label.quantity')}" />
                                             </mx:GridItem>
                                             <mx:GridItem width="30%">
                                                <mx:Label text="{queryResult.selectedCancelCompletionView.quantityStr}"/>
                                             </mx:GridItem>
                                             <mx:GridItem width="20%" styleName="LabelBgColor">
                                                <mx:Label text="{this.parentApplication.xResourceManager.getKeyValue('stl.label.deliverreceive')}" />
                                             </mx:GridItem>
                                             <mx:GridItem width="30%">
                                                <mx:Label text="{queryResult.selectedCompletionDetails.deliverReceive}"/>
                                             </mx:GridItem>
                                         </mx:GridRow>
                                    </mx:Grid>
                                </flexlib:WindowShade>
                                <flexlib:WindowShade id="ws2" tabChildren="{ws2.opened=true}" styleName="linkButtonWindowShade" label="Cash Side Settlement Details" width="100%" visible="{queryResult.selectedCompletionDetails.cashSidePresent == true}" includeInLayout="{queryResult.selectedCompletionDetails.cashSidePresent == true}">
                                    <mx:Grid verticalGap="0" horizontalGap="0" width="100%">
                                         <mx:GridRow width="100%">
                                             <mx:GridItem width="20%" styleName="LabelBgColor">
                                                <mx:Label text="{this.parentApplication.xResourceManager.getKeyValue('stl.label.settlementbank')}" />
                                             </mx:GridItem>
                                             <mx:GridItem width="30%">
                                                <mx:Label text="{queryResult.selectedCompletionDetails.settleBankCash}"/>
                                             </mx:GridItem>
                                             <mx:GridItem width="20%" styleName="LabelBgColor">
                                                <mx:Label text="{this.parentApplication.xResourceManager.getKeyValue('stl.label.settleac')}" />
                                             </mx:GridItem>
                                             <mx:GridItem width="30%">
                                                <mx:Label text="{queryResult.selectedCompletionDetails.settleAccountCash}"/>
                                             </mx:GridItem>             
                                         </mx:GridRow>
                                         <mx:GridRow width="100%">
                                             <mx:GridItem width="20%" styleName="LabelBgColor">
                                                <mx:Label text="{this.parentApplication.xResourceManager.getKeyValue('stl.label.ccy')}" />
                                             </mx:GridItem>
                                             <mx:GridItem width="30%">
                                                <mx:Label text="{queryResult.selectedCancelCompletionView.ccyCode}"/>
                                             </mx:GridItem>
                                             <mx:GridItem width="20%" styleName="LabelBgColor">
                                                <mx:Label text="{this.parentApplication.xResourceManager.getKeyValue('stl.label.paymentreceive')}" />
                                             </mx:GridItem>
                                             <mx:GridItem width="30%">
                                                <mx:Label text="{queryResult.selectedCompletionDetails.paymentReceive}"/>
                                             </mx:GridItem>
                                         </mx:GridRow>
                                         <mx:GridRow width="100%">
                                             <mx:GridItem width="20%" styleName="LabelBgColor">
                                                <mx:Label text="{this.parentApplication.xResourceManager.getKeyValue('stl.label.amount')}" />
                                             </mx:GridItem>
                                             <mx:GridItem width="30%">
                                                <mx:Label text="{queryResult.selectedCancelCompletionView.amountStr}"/>
                                             </mx:GridItem>
                                             <mx:GridItem width="20%" styleName="LabelBgColor">                                                
                                             </mx:GridItem>
                                             <mx:GridItem width="30%">
                                                <mx:Label text=""/>
                                             </mx:GridItem>
                                         </mx:GridRow>
                                    </mx:Grid>
                                </flexlib:WindowShade>
                            </mx:VBox>
                        </mx:Canvas>
                        <mx:HBox width="100%" styleName="ButtonBackPanel" horizontalAlign="left">
			                <mx:Button id="okButton" label="OK" styleName="BtnStyle" click="okRemarkPopup()"/>
			                <mx:Button id="cancelButton" label="Cancel" styleName="BtnStyle" click="closeRemarkPopup()"/>
                        </mx:HBox>                          
                    </mx:VBox> 
                </mx:target>
            </mx:AddChild>          
        </mx:State>
        <mx:State name="completionEntry">
            <mx:AddChild position="lastChild">
                <mx:target>
                    <mx:VBox id="entryBox" width="100%" height="100%" verticalGap="0" horizontalGap="0" >
                        <cntrls:XenosErrors id="errPageCompEntry" width="100%" color="#FF0000" backgroundAlpha="0" borderStyle="none"/>
                        <mx:Canvas width="100%" height="100%" horizontalScrollPolicy="auto" verticalScrollPolicy="auto">
                            <mx:VBox width="100%" height="100%">
                                <mx:Grid verticalGap="0" horizontalGap="0" width="100%">
                                     <mx:GridRow width="100%">
                                         <mx:GridItem width="20%" styleName="LabelBgColor">
                                            <mx:Label text="{this.parentApplication.xResourceManager.getKeyValue('stl.label.settlementreferenceno')}" />
                                         </mx:GridItem>
                                         <mx:GridItem width="30%">
                                            <mx:Label text="{queryResult.selectedCompletionView.settlementReferenceNo}"/>
                                         </mx:GridItem>
                                         <mx:GridItem width="20%" styleName="LabelBgColor">
                                            <mx:Label text="{this.parentApplication.xResourceManager.getKeyValue('stl.label.valuedate')}" />
                                         </mx:GridItem>
                                         <mx:GridItem width="30%">
                                            <mx:Label text="{queryResult.selectedCompletionView.valueDateStr}"/>
                                         </mx:GridItem>             
                                     </mx:GridRow>
                                     <mx:GridRow width="100%">
                                         <mx:GridItem width="20%" styleName="LabelBgColor">
                                            <mx:Label text="{this.parentApplication.xResourceManager.getKeyValue('stl.label.completionstatus')}" />
                                         </mx:GridItem>
                                         <mx:GridItem width="30%">
                                            <mx:Label text="{queryResult.selectedCompletionView.settlementStatus}"/>
                                         </mx:GridItem>
                                         <mx:GridItem width="20%" styleName="LabelBgColor">
                                            <mx:Label text="{this.parentApplication.xResourceManager.getKeyValue('stl.label.completiontype')}" />
                                         </mx:GridItem>
                                         <mx:GridItem width="30%">
                                            <mx:Label text="{completionType}"/>
                                         </mx:GridItem>
                                     </mx:GridRow>
                                     <mx:GridRow width="100%">
                                         <mx:GridItem width="20%" styleName="LabelBgColor">
                                            <mx:Label text="{this.parentApplication.xResourceManager.getKeyValue('stl.label.settlementdate')}" />
                                         </mx:GridItem>
                                         <mx:GridItem width="30%">
                                            <mx:DateField id="stlDate" formatString="YYYYMMDD" editable="true" width="90" selectedDate="{DateField.stringToDate(settleDate, 'YYYYMMDD')}" restrict="0-9"/>
                                         </mx:GridItem>
                                         <mx:GridItem width="20%" styleName="LabelBgColor">
                                            <mx:Label text="{this.parentApplication.xResourceManager.getKeyValue('stl.label.remarks1')}" />
                                         </mx:GridItem>
                                         <mx:GridItem width="30%">
                                            <mx:TextInput id="remarks1Ent" restrict="{Globals.INPUT_PATTERN}"/>
                                         </mx:GridItem>
                                     </mx:GridRow>
                                     <mx:GridRow width="100%">
                                         <mx:GridItem width="20%" styleName="LabelBgColor">
                                            <mx:Label text="{this.parentApplication.xResourceManager.getKeyValue('stl.label.remarks2')}" />
                                         </mx:GridItem>
                                         <mx:GridItem width="30%">
                                            <mx:TextInput id="remarks2Ent" restrict="{Globals.INPUT_PATTERN}"/>
                                         </mx:GridItem>
                                         <mx:GridItem width="20%" styleName="LabelBgColor">
                                            <mx:Label text="{this.parentApplication.xResourceManager.getKeyValue('stl.label.reasoncode')}" />
                                         </mx:GridItem>
                                         <mx:GridItem width="30%">
                                            <mx:ComboBox id="reasonCodeEnt" dataProvider="{reasonCodeList}" labelField="label" width="160"/>
                                            <mx:Button id="addButton1" label="Add" styleName="BtnStyle" click="addReasonCode()"/>
                                         </mx:GridItem>
                                     </mx:GridRow>
                                     <mx:GridRow width="100%">
                                         <mx:GridItem width="20%" styleName="LabelBgColor">
                                            <mx:Label text="{this.parentApplication.xResourceManager.getKeyValue('stl.label.narrative')}" />
                                         </mx:GridItem>
                                         <mx:GridItem width="30%">
                                            <mx:TextInput id="narrativeEnt" restrict="{Globals.INPUT_PATTERN}"/>
                                         </mx:GridItem>
                                         <mx:GridItem width="20%" styleName="LabelBgColor">
                                         </mx:GridItem>
                                         <mx:GridItem width="30%">
                                         </mx:GridItem>
                                     </mx:GridRow>
                                </mx:Grid>
                                <mx:VBox width="100%" height="60" id="rslt1" horizontalScrollPolicy="off" verticalScrollPolicy="off" styleName="HDivideStyle" visible="{reasonCodeResult.length > 0}" includeInLayout="{reasonCodeResult.length > 0}">
                                    <cntrls:CustomDataGrid id="reasonCodeSummary1" width="100%" height="100%" dataProvider="{reasonCodeResult}" sortableColumns="true" variableRowHeight="true" horizontalScrollPolicy="off" verticalScrollPolicy="off">
                                        <cntrls:columns>
                                            <mx:DataGridColumn textAlign="center" headerText="{this.parentApplication.xResourceManager.getKeyValue('stl.label.reasoncode')}" dataField="reasonCode" rendererIsEditor="true"/>
                                            <mx:DataGridColumn textAlign="center" headerText="{this.parentApplication.xResourceManager.getKeyValue('stl.label.narrative')}" dataField="narrative" rendererIsEditor="true"/>
                                            <mx:DataGridColumn textAlign="center" rendererIsEditor="true">
                                                <mx:itemRenderer>
                                                <mx:Component>
                                                    <mx:HBox width="100%" height="100%" horizontalAlign="center" verticalAlign="middle" horizontalScrollPolicy="off" verticalScrollPolicy="off">
                                                        <mx:Button id="btn2" label="delete" width="18" height="18" styleName="BtnDelete" click="this.parentDocument.deleteReasonCode(outerDocument.reasonCodeSummary1.selectedIndex)"/>
                                                    </mx:HBox>
                                                </mx:Component>
                                                </mx:itemRenderer> 
                                            </mx:DataGridColumn>
                                       </cntrls:columns>
                                   </cntrls:CustomDataGrid>
                                </mx:VBox>          
                                <flexlib:WindowShade id="ws3" tabChildren="{ws1.opened=true}" styleName="linkButtonWindowShade" label="{this.parentApplication.xResourceManager.getKeyValue('stl.label.completion.entry.completiondetails.securityside.settlementdetails')}" width="100%" visible="{queryResult.selectedCompletionDetails.securitySidePresent == true}" includeInLayout="{queryResult.selectedCompletionDetails.securitySidePresent == true}">
                                    <mx:Grid verticalGap="0" horizontalGap="0" width="100%">
                                         <mx:GridRow width="100%">
                                             <mx:GridItem width="20%" styleName="LabelBgColor">
                                                <mx:Label text="{this.parentApplication.xResourceManager.getKeyValue('stl.label.settlementbank')}" />
                                             </mx:GridItem>
                                             <mx:GridItem width="30%">
                                                <mx:Label text="{queryResult.selectedCompletionDetails.settleBankSecurity}"/>
                                             </mx:GridItem>
                                             <mx:GridItem width="20%" styleName="LabelBgColor">
                                                <mx:Label text="{this.parentApplication.xResourceManager.getKeyValue('stl.label.settleac')}" />
                                             </mx:GridItem>
                                             <mx:GridItem width="30%">
                                                <mx:Label text="{queryResult.selectedCompletionDetails.settleAccountSecurity}"/>
                                             </mx:GridItem>             
                                         </mx:GridRow>
                                         <mx:GridRow width="100%">
                                             <mx:GridItem width="20%" styleName="LabelBgColor">
                                                <mx:Label text="{this.parentApplication.xResourceManager.getKeyValue('stl.label.securitycode')}" />
                                             </mx:GridItem>
                                             <mx:GridItem width="30%">
                                                <mx:Label text="{queryResult.selectedCompletionView.instrumentCode}"/>
                                             </mx:GridItem>
                                             <mx:GridItem width="20%" styleName="LabelBgColor">
                                                <mx:Label text="{this.parentApplication.xResourceManager.getKeyValue('stl.label.securityname')}" />
                                             </mx:GridItem>
                                             <mx:GridItem width="30%">
                                                <mx:Label text="{queryResult.selectedCompletionView.securityName}"/>
                                             </mx:GridItem>
                                         </mx:GridRow>
                                         <mx:GridRow width="100%">
                                             <mx:GridItem width="20%" styleName="LabelBgColor">
                                                <mx:Label text="{this.parentApplication.xResourceManager.getKeyValue('ref.common.label.alternatesecurityid')}" />
                                             </mx:GridItem>
                                             <mx:GridItem width="80%" colSpan="3">
                                                <mx:Label text="{queryResult.selectedCompletionView.displayAlternativeSecId}"/>
                                             </mx:GridItem>
                                         </mx:GridRow>
                                         <mx:GridRow width="100%">
                                             <mx:GridItem width="20%" styleName="LabelBgColor">
                                                <mx:Label text="{this.parentApplication.xResourceManager.getKeyValue('stl.label.deliverreceive')}" />
                                             </mx:GridItem>
                                             <mx:GridItem width="30%">
                                                <mx:Label text="{queryResult.selectedCompletionDetails.deliverReceive}"/>
                                             </mx:GridItem>
                                             <mx:GridItem width="20%" styleName="LabelBgColor">
                                                <mx:Label text="{this.parentApplication.xResourceManager.getKeyValue('stl.label.quantity')}" />
                                             </mx:GridItem>
                                             <mx:GridItem width="30%">
                                                <mx:Label text="{queryResult.selectedCompletionView.quantityStr}"/>
                                             </mx:GridItem>
                                         </mx:GridRow>
                                         <mx:GridRow width="100%">
                                             <mx:GridItem width="20%" styleName="LabelBgColor">
                                                <mx:Label text="{this.parentApplication.xResourceManager.getKeyValue('stl.label.outstandingquantity')}" />
                                             </mx:GridItem>
                                             <mx:GridItem width="30%">
                                                <mx:Label text="{queryResult.selectedCompletionView.outstandingQuantityStr}"/>
                                             </mx:GridItem>
                                             <mx:GridItem width="20%" styleName="LabelBgColor">
                                                <mx:Label text="{this.parentApplication.xResourceManager.getKeyValue('stl.label.completionquantity')}" styleName="ReqdLabel" includeInLayout="{completionType == 'PARTIAL' || completionType == 'PARTIAL_QUASI_COMPLETE'}" visible="{completionType == 'PARTIAL' || completionType == 'PARTIAL_QUASI_COMPLETE'}"/>
                                                <mx:Label text="{this.parentApplication.xResourceManager.getKeyValue('stl.label.completionquantity')}" includeInLayout="{completionType != 'PARTIAL' &amp;&amp; completionType != 'PARTIAL_QUASI_COMPLETE'}" visible="{completionType != 'PARTIAL' &amp;&amp; completionType != 'PARTIAL_QUASI_COMPLETE'}"/>
                                             </mx:GridItem>
                                             <mx:GridItem width="30%">
                                                <mx:Label text="{queryResult.selectedCompletionDetails.completeQuantityStr}" includeInLayout="{completionType != 'PARTIAL' &amp;&amp; completionType != 'PARTIAL_QUASI_COMPLETE'}" visible="{completionType != 'PARTIAL' &amp;&amp; completionType != 'PARTIAL_QUASI_COMPLETE'}"/>
                                                <mx:TextInput id="completionQuantity" text="{queryResult.selectedCompletionDetails.completeQuantityStr}" includeInLayout="{completionType == 'PARTIAL' || completionType == 'PARTIAL_QUASI_COMPLETE'}" visible="{completionType == 'PARTIAL' || completionType == 'PARTIAL_QUASI_COMPLETE'}" restrict="0-9.,MmBbTt" focusOut="completionQuantityVal.handleNumericField(numberFormatter)"/>
                                             </mx:GridItem>
                                         </mx:GridRow>
                                    </mx:Grid>
                                </flexlib:WindowShade>
                                <flexlib:WindowShade id="ws4" tabChildren="{ws2.opened=true}" styleName="linkButtonWindowShade" label="{this.parentApplication.xResourceManager.getKeyValue('stl.label.completion.entry.completiondetails.cashside.settlementdetails')}" width="100%" visible="{queryResult.selectedCompletionDetails.cashSidePresent == true}" includeInLayout="{queryResult.selectedCompletionDetails.cashSidePresent == true}">
                                    <mx:Grid verticalGap="0" horizontalGap="0" width="100%">
                                         <mx:GridRow width="100%">
                                             <mx:GridItem width="20%" styleName="LabelBgColor">
                                                <mx:Label text="{this.parentApplication.xResourceManager.getKeyValue('stl.label.settlementbank')}" />
                                             </mx:GridItem>
                                             <mx:GridItem width="30%">
                                                <mx:Label text="{queryResult.selectedCompletionDetails.settleBankCash}"/>
                                             </mx:GridItem>
                                             <mx:GridItem width="20%" styleName="LabelBgColor">
                                                <mx:Label text="{this.parentApplication.xResourceManager.getKeyValue('stl.label.settleac')}" />
                                             </mx:GridItem>
                                             <mx:GridItem width="30%">
                                                <mx:Label text="{queryResult.selectedCompletionDetails.settleAccountCash}"/>
                                             </mx:GridItem>             
                                         </mx:GridRow>
                                         <mx:GridRow width="100%">
                                             <mx:GridItem width="20%" styleName="LabelBgColor">
                                                <mx:Label text="{this.parentApplication.xResourceManager.getKeyValue('stl.label.ccy')}" />
                                             </mx:GridItem>
                                             <mx:GridItem width="30%">
                                                <mx:Label text="{queryResult.selectedCompletionView.ccyCode}"/>
                                             </mx:GridItem>
                                             <mx:GridItem width="20%" styleName="LabelBgColor">
                                                <mx:Label text="{this.parentApplication.xResourceManager.getKeyValue('stl.label.paymentreceive')}" />
                                             </mx:GridItem>
                                             <mx:GridItem width="30%">
                                                <mx:Label text="{queryResult.selectedCompletionDetails.paymentReceive}"/>
                                             </mx:GridItem>
                                         </mx:GridRow>
                                         <mx:GridRow width="100%">
                                             <mx:GridItem width="20%" styleName="LabelBgColor">
                                                <mx:Label text="{this.parentApplication.xResourceManager.getKeyValue('stl.label.amount')}" />
                                             </mx:GridItem>
                                             <mx:GridItem width="30%">
                                                <mx:Label text="{queryResult.selectedCompletionView.amountStr}"/>
                                             </mx:GridItem>
                                             <mx:GridItem width="20%" styleName="LabelBgColor">
                                                <mx:Label text="{this.parentApplication.xResourceManager.getKeyValue('stl.label.outstandingamount')}" />
                                             </mx:GridItem>
                                             <mx:GridItem width="30%">
                                                <mx:Label text="{queryResult.selectedCompletionView.outstandingAmountStr}"/>
                                             </mx:GridItem>
                                         </mx:GridRow>
                                         <mx:GridRow width="100%" visible="{queryResult.selectedCompletionDetails.partialCompletionEligible == 'Y'}" includeInLayout="{queryResult.selectedCompletionDetails.partialCompletionEligible == 'Y'}">
                                             <mx:GridItem width="20%" styleName="LabelBgColor">
                                                <mx:Label text="{this.parentApplication.xResourceManager.getKeyValue('stl.label.sharebalance')}" styleName="{this.mode == 'CAX_RECEIVE_NOTICE' ? '' : 'ReqdLabel'}"/>
                                             </mx:GridItem>
                                             <mx:GridItem width="30%">
                                                <mx:TextInput id="eligibleBalance" text="{queryResult.selectedCompletionDetails.totalEligibleStr}" restrict="0-9.,MmBbTt" focusOut="eligibleBalanceVal.handleNumericField(numberFormatter)"/>
                                                <mx:Label id="lblEligibleBalance" text="{queryResult.selectedCompletionDetails.totalEligibleStr}" includeInLayout="false" visible="false" />
                                             </mx:GridItem>
                                             <mx:GridItem width="20%" styleName="LabelBgColor">
                                                <mx:Label text="{this.parentApplication.xResourceManager.getKeyValue('stl.label.taxamount')}" styleName="{this.mode == 'CAX_RECEIVE_NOTICE' ? '' : 'ReqdLabel'}"/>
                                             </mx:GridItem>
                                             <mx:GridItem width="30%">
                                                <mx:TextInput id="taxAmount" text="{queryResult.selectedCompletionDetails.taxAmountStr}" restrict="0-9.,MmBbTt" focusOut="taxAmountVal.handleNumericField(numberFormatter)"/>
                                                <mx:Label id="lblTaxAmount" text="{queryResult.selectedCompletionDetails.taxAmountStr}" includeInLayout="false" visible="false"/>
                                             </mx:GridItem>
                                         </mx:GridRow>
                                         <mx:GridRow width="100%">
                                             <mx:GridItem width="20%" styleName="LabelBgColor">
                                                <mx:Label text="{this.parentApplication.xResourceManager.getKeyValue('stl.label.completionamount')}"  includeInLayout="{completionType != 'PARTIAL' &amp;&amp; completionType != 'PARTIAL_QUASI_COMPLETE'}" visible="{completionType != 'PARTIAL' &amp;&amp; completionType != 'PARTIAL_QUASI_COMPLETE'}"/>
                                                <mx:Label text="{this.parentApplication.xResourceManager.getKeyValue('stl.label.completionamount')}" styleName="ReqdLabel" includeInLayout="{completionType == 'PARTIAL' || completionType == 'PARTIAL_QUASI_COMPLETE'}" visible="{completionType == 'PARTIAL' || completionType == 'PARTIAL_QUASI_COMPLETE'}"/>
                                             </mx:GridItem>
                                             <mx:GridItem width="30%">
                                                <mx:Label text="{queryResult.selectedCompletionDetails.completeAmountStr}" includeInLayout="{completionType == 'QUASI_COMPLETE'}" visible="{completionType == 'QUASI_COMPLETE'}"/>
                                                <mx:TextInput id="completeAmountPartial" text="{queryResult.selectedCompletionDetails.completeAmountStr}" includeInLayout="{completionType == 'PARTIAL' || completionType == 'PARTIAL_QUASI_COMPLETE'}" visible="{completionType == 'PARTIAL' || completionType == 'PARTIAL_QUASI_COMPLETE'}" focusOut="completeAmountPartialVal.handleNumericField(numberFormatter)" restrict="0-9.,MmBbTt"/>
                                                <mx:TextInput id="completeAmountComplete" text="{queryResult.selectedCompletionDetails.completeAmountStr}"  includeInLayout="{completionType == 'COMPLETE'}" visible="{completionType == 'COMPLETE'}" focusOut="completeAmountCompleteVal.handleNumericField(numberFormatter)" restrict="0-9.,MmBbTt"/>
                                             </mx:GridItem>
                                             <mx:GridItem width="20%" styleName="LabelBgColor">
                                             </mx:GridItem>
                                             <mx:GridItem width="30%">
                                             </mx:GridItem>
                                         </mx:GridRow>
                                    </mx:Grid>
                                </flexlib:WindowShade>
                            </mx:VBox>
                        </mx:Canvas>
                        <mx:HBox width="100%" styleName="ButtonBackPanel" horizontalAlign="left">
                            <mx:Button id="okButtonEnt" label="OK" styleName="BtnStyle" click="okRemarkPopup()"/>
                            <mx:Button id="cancelButtonEnt" label="Cancel" styleName="BtnStyle" click="closeRemarkPopup()"/>
                        </mx:HBox>                          
                    </mx:VBox> 
                </mx:target>
            </mx:AddChild>          
        </mx:State>
    </mx:states>    
</mx:Module>